<html>
  <head>
    <link rel="stylesheet" type="text/css" href="index.css" />
  </head>
  <body>
    <section class="header">
      <div id="brand">
	<h1 style="vertical-align: top;">PicShare</h1>
      </div>
      <div id="actions">
	<button id="quit-button" onclick="exit();">Quit</button>
      </div>
    </section>

    <div class="content">
      <ul class="photo-list" id="photoList">
      </ul>
    </div>

    <script type="text/javascript" src="moment.js"></script>
    <script>
      var ipc = require('ipc');
      var exit = function() {
        ipc.send('exit', true);
      }
      
      ipc.on('pictures', function(message) {
        photoHTML = ""
        for(var i = 0; i < message.images.length; i++) {
	   photoHTML += "<li class='table-row'>";
	   photoHTML += "<img class='thumbnail' src='" + message.root + "/v1/app/" + message.appid + "/binary/" + message.images[i].filename + "?apikey=" + message.apikey + "' />"
	   photoHTML += "<a href='" + message.root + "/v1/app/" + message.appid + "/binary/" + message.images[i].filename + "?apikey=" + message.apikey + "' target=_blank>"
	   photoHTML += message.images[i].filename;
	   photoHTML += "</a><br>"
	   photoHTML += "<p class='date-added'>added "
           photoHTML += moment(message.images[i]['__created__']).from(moment())
           photoHTML += "</p>"
	   photoHTML += "</li>";
        }
        document.getElementById("photoList").innerHTML = photoHTML
        console.log('message:' + message);
      });
    </script>
  </body>
</html>
