<html>
  <head>
    <link rel="stylesheet" type="text/css" href="login.css"></link>
    <link rel="stylesheet" type="text/css" href="index.css"></link>    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css"></link>
  </head>
  <body>
    <section class="header">
      <div id="brand">
        <h1 class="title">PicShare</h1>
      </div>
      <div id="actions">
	<i class="fa fa-cog" onclick="openSettings()"></i>
      </div>
    </section>  
    <div class="login-content" style="width: 100%; text-align: center;">
      <img id="logo" src="./img/upload-cloud.svg" width="45%" />
      <div id="errorLabel" style="display: none;">
	<p style="color: red">Invalid username</p>
      </div>
      <div id="login-container">
	<form class="login-form" name="loginForm" onsubmit="return;">
	  <div class="input-container">
	    <input type="text" id="email" placeholder="username"/>
	  </div>
	  <div class="input-container">
	    <input type="password" id="password" flex="flex" placeholder="password"/>
	  </div>
	  <div>
	    <button type='submit' onclick="login();">Login</button>
	    <button onclick="register();">Register</a>
	  </div>	
	</form>
      </div>

    </div>
    <script>
      var ipc = require('electron').ipcRenderer;

      ipc.on('errorMessage', function(event, errorMessage) {
        console.log("Error!", errorMessage)
        document.getElementById("errorLabel").style.display = 'visible'
      });

      var register = function(event) {
        email = document.getElementById('email').value
        password = document.getElementById('password').value

        console.log("Email:", email);
        console.log("Password:", password);
      
        if( email.length === 0 || password.length === 0 ) {
          document.getElementById('errorLabel').innerHTML = '<p>Email and password required to register</p>';
          return;
        }
        ipc.send('register', {'username': email, 'password': password});
      }
      
      
      var login = function() {
        ipc.send('login', {'email': document.getElementById('email').value, 'password': document.getElementById('password').value});
      }

      user = localStorage.getItem('user');
      console.log(user);
      
      if(user) {
        ipc.send('storedUser', user);
      }

      var openSettings = function() {
        ipc.send('openSettings');
      }


      remote = require('electron').remote;
      Menu = remote.Menu;
      MenuItem = remote.MenuItem;
			   
      var menu = new Menu();
      menu.append(new MenuItem({ label: 'Dev tools', click: function() { ipc.send('openDevTools'); } }));
      menu.append(new MenuItem({ type: 'separator' }));
      menu.append(new MenuItem({ label: 'Quit', click: function() { ipc.send('quit'); } }));			   

      ipc.on('contextMenu', function(event) {
        console.log("CONTEXT MENU");		   
        menu.popup();
      });
      

    </script>
  </body>
</html>
